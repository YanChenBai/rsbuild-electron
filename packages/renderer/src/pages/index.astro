---
import Layout from '../layouts/Layout.astro'
---

<script>
import { invoke } from '@byc/tipc'

function selectBtnById(id: string, cb: () => void) {
  return document.querySelector<HTMLButtonElement>(`#${id}`)?.addEventListener('click', cb)
}

window.onload = () => {
  selectBtnById('min', () => {
    invoke.window.min()
  })

  selectBtnById('max', () => {
    invoke.window.max()
  })

  selectBtnById('close', () => {
    invoke.window.close()
  })

  selectBtnById('config-get', () => {
    invoke.config.getAll()
      .then((res) => {
        // eslint-disable-next-line no-console
        console.log(res)
      })
  })

  let count = 1
  selectBtnById('config-add', () => {
    invoke.config.setItem(`test${count++}`, 'test')
    // eslint-disable-next-line no-console
      .then(console.log)
  })

  selectBtnById('get-user-list', () => {
    invoke.window.ipv4()
      .then((res) => {
        // eslint-disable-next-line no-console
        console.log(res)
      })
  })
}
</script>

<Layout>
  <div class="p2">
    <button id="min" class="px2 py1">最小化</button>
    <button id="max" class="px2 py1">最大化</button>
    <button id="close" class="px2 py1">关闭</button>
    <button id="config-get" class="px2 py1">Get config</button>
    <button id="config-add" class="px2 py1">Add config</button>
    <button id="get-user-list" class="px2 py1">Get user list</button>
  </div>
</Layout>
